<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Register | TechForge</title>
  <link rel="stylesheet" href="../style.css">

  <style>
    .form-card {
      max-width: 480px;
      margin: 120px auto 40px;
      background: rgba(14,14,14,0.9);
      padding: 35px;
      border-radius: 20px;
      border: 1px solid rgba(212,175,55,0.6);
      box-shadow: 0 0 35px rgba(212,175,55,0.3);
    }

    .form-card h1 {
      text-align: center;
      color: #d4af37;
      margin-bottom: 20px;
    }

    .form-card input,
    .form-card select {
      width: 100%;
      padding: 12px 14px;
      margin-top: 12px;
      border-radius: 10px;
      border: none;
      font-size: 15px;
    }

    .team-title {
      margin-top: 18px;
      font-size: 14px;
      color: #ffd700;
    }

    .price-box {
      margin-top: 18px;
      padding: 12px;
      border-radius: 10px;
      background: #111;
      border: 1px dashed #d4af37;
      text-align: center;
      font-size: 16px;
      color: #ffd700;
    }

    .form-card button {
      margin-top: 25px;
      width: 100%;
      padding: 14px;
      font-size: 18px;
      font-weight: 700;
      border-radius: 40px;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg, #d4af37, #ffd700);
      color: #0e0e0e;
      box-shadow: 0 0 25px rgba(212,175,55,0.7);
    }

    .hint {
      font-size: 13px;
      opacity: 0.8;
      margin-top: 6px;
    }
  </style>
</head>
<body>

<!-- ================= NAVBAR ================= -->
<nav class="navbar">
  <div class="logo">
    <img src="../college-logo.png" alt="College Logo">
  </div>
  <div class="center-logo">
    <img src="../techforge.png" alt="TechForge Logo">
  </div>
  <div class="hamburger" onclick="openMenu()">☰</div>
  <ul class="nav-links">
    <li><a href="../index.html">Home</a></li>
    <li><a href="events.html">Events</a></li>
    <li><a href="workshops.html">Workshops</a></li>
    <li><a href="expo.html">Expo</a></li>
    <li><a href="developers.html">Developers</a></li>
  </ul>
</nav>

<!-- ================= MOBILE MENU ================= -->
<div id="mobileMenu" class="mobile-menu">
  <span class="close-menu" onclick="closeMenu()">×</span>
  <a href="../index.html" onclick="closeMenu()">Home</a>
  <a href="events.html" onclick="closeMenu()">Events</a>
  <a href="workshops.html" onclick="closeMenu()">Workshops</a>
  <a href="expo.html" onclick="closeMenu()">Expo</a>
  <a href="developers.html" onclick="closeMenu()">Developers</a>
</div>

<div class="form-card">
  <h1>Event Registration</h1>

  <form id="registerForm">

    <!-- MAIN CONTACT -->
    <input type="text" id="name1" placeholder="Name (Required)" required>
    <input type="text" id="college1" placeholder="College Name" required>
    <select id="degree1" required>
      <option value="">Select Degree</option>
      <option value="B.E">B.E</option>
      <option value="B.Tech">B.Tech</option>
      <option value="B.Sc">B.Sc</option>
      <option value="MBA">MBA</option>
    </select>
    <input type="text" id="dept1" placeholder="Department" required>
    <select id="year1" required>
      <option value="">Select Year</option>
      <option value="1st Year">1st Year</option>
      <option value="2nd Year">2nd Year</option>
      <option value="3rd Year">3rd Year</option>
      <option value="4th Year">4th Year</option>
    </select>
    <input type="email" id="email" placeholder="Email (Team Contact)" required>
    <input type="tel" id="phone" placeholder="Phone Number" required>

    <!-- EVENT -->
    <select id="event" required>
      <option value="">Select Event</option>
      <option value="CodeCraft Quiz">CodeCraft Quiz</option>
      <option value="WebNOVA AI">WebNOVA AI</option>
      <option value="Poster Bot">Poster Bot</option>
      <option value="Comic Intelligence">Comic Intelligence</option>
      <option value="Maze Solver">Maze Solver</option>
      <option value="BrainByte Bash">BrainByte Bash</option>
      <option value="Thinkify">Thinkify</option>
      <option value="Code Relay">Code Relay</option>
      <option value="Mismatch The Code">Mismatch The Code</option>
      <option value="Tech Connections">Tech Connections</option>
    </select>

    <!-- TEAM -->
    <div id="teamSection" style="display:none">
      <div class="team-title">Team Members</div>
      
      <div id="teamMember2" style="display:none">
        <div style="margin-top:12px; padding-top:12px; border-top:1px solid #d4af37; opacity:0.7;"><span id="label2">Member 1</span></div>
        <input type="text" id="name2" placeholder="Member 1 Name (Optional)">
        <input type="text" id="college2" placeholder="College Name">
        <select id="degree2">
          <option value="">Select Degree</option>
          <option value="B.E">B.E</option>
          <option value="B.Tech">B.Tech</option>
          <option value="B.Sc">B.Sc</option>
          <option value="MBA">MBA</option>
        </select>
        <input type="text" id="dept2" placeholder="Department">
        <select id="year2">
          <option value="">Select Year</option>
          <option value="1st Year">1st Year</option>
          <option value="2nd Year">2nd Year</option>
          <option value="3rd Year">3rd Year</option>
          <option value="4th Year">4th Year</option>
        </select>
      </div>

      <div id="teamMember3" style="display:none">
        <div style="margin-top:12px; padding-top:12px; border-top:1px solid #d4af37; opacity:0.7;"><span id="label3">Member 2</span></div>
        <input type="text" id="name3" placeholder="Member 2 Name (Optional)">
        <input type="text" id="college3" placeholder="College Name">
        <select id="degree3">
          <option value="">Select Degree</option>
          <option value="B.E">B.E</option>
          <option value="B.Tech">B.Tech</option>
          <option value="B.Sc">B.Sc</option>
          <option value="MBA">MBA</option>
        </select>
        <input type="text" id="dept3" placeholder="Department">
        <select id="year3">
          <option value="">Select Year</option>
          <option value="1st Year">1st Year</option>
          <option value="2nd Year">2nd Year</option>
          <option value="3rd Year">3rd Year</option>
          <option value="4th Year">4th Year</option>
        </select>
      </div>

      <div id="teamMember4" style="display:none">
        <div style="margin-top:12px; padding-top:12px; border-top:1px solid #d4af37; opacity:0.7;"><span id="label4">Member 3</span></div>
        <input type="text" id="name4" placeholder="Member 3 Name (Optional)">
        <input type="text" id="college4" placeholder="College Name">
        <select id="degree4">
          <option value="">Select Degree</option>
          <option value="B.E">B.E</option>
          <option value="B.Tech">B.Tech</option>
          <option value="B.Sc">B.Sc</option>
          <option value="MBA">MBA</option>
        </select>
        <input type="text" id="dept4" placeholder="Department">
        <select id="year4">
          <option value="">Select Year</option>
          <option value="1st Year">1st Year</option>
          <option value="2nd Year">2nd Year</option>
          <option value="3rd Year">3rd Year</option>
          <option value="4th Year">4th Year</option>
        </select>
      </div>
      <div class="hint" id="teamHint"></div>
    </div>

    <!-- PRICE -->
    <div class="price-box" id="priceBox">
      Select an event to see price
    </div>

    <button type="submit">Proceed to Payment</button>
  </form>
</div>

<script>
/* EVENT CONFIG (frontend reference only) */
const eventConfig = {
  "CodeCraft Quiz": {
    type: "SOLO",
    price: 150,
    minTeamSize: 1,
    maxTeamSize: 1
  },
  "WebNOVA AI": {
    type: "TEAM",
    price: 300,
    minTeamSize: 2,
    maxTeamSize: 3
  },
  "Poster Bot": {
    type: "SOLO",
    price: 100,
    minTeamSize: 1,
    maxTeamSize: 1
  },
  "Comic Intelligence": {
    type: "SOLO",
    price: 100,
    minTeamSize: 1,
    maxTeamSize: 1
  },
  "Maze Solver": {
    type: "SOLO",
    price: 250,
    minTeamSize: 1,
    maxTeamSize: 1
  },
  "BrainByte Bash": {
    type: "SOLO",
    price: 150,
    minTeamSize: 1,
    maxTeamSize: 1
  },
  "Thinkify": {
    type: "TEAM",
    price: 200,
    minTeamSize: 2,
    maxTeamSize: 3
  },
  "Code Relay": {
    type: "TEAM",
    price: 250,
    minTeamSize: 3,
    maxTeamSize: 3
  },
  "Mismatch The Code": {
    type: "TEAM",
    price: 150,
    minTeamSize: 2,
    maxTeamSize: 2
  },
  "Tech Connections": {
    type: "TEAM",
    price: 100,
    minTeamSize: 2,
    maxTeamSize: 3
  }
};

const eventSelect = document.getElementById("event");
const teamSection = document.getElementById("teamSection");
const teamHint = document.getElementById("teamHint");
const priceBox = document.getElementById("priceBox");

const teamInputs = [
  document.getElementById("name2"),
  document.getElementById("name3"),
  document.getElementById("name4")
];

const teamMembers = [
  document.getElementById("teamMember2"),
  document.getElementById("teamMember3"),
  document.getElementById("teamMember4")
];

/* EVENT CHANGE */
eventSelect.addEventListener("change", updateForm);

function updateForm() {
  const event = eventSelect.value;
  const config = eventConfig[event];

  if (!config) {
    teamSection.style.display = "none";
    priceBox.innerText = "Select an event to see price";
    return;
  }
  // persist amount so payment page can read it directly
  localStorage.setItem("amount", config.price);

  priceBox.innerText = `Registration Fee: ₹${config.price}`;

  if (config.type === "SOLO") {
    teamSection.style.display = "none";
    teamInputs.forEach(i => i.value = "");
    
    // Update label to show "Name" for solo events
    document.getElementById("name1").placeholder = "Name (Required)";
  } else {
    teamSection.style.display = "block";
    
    // Update label to show "Team Leader" for team events
    document.getElementById("name1").placeholder = "Team Leader Name (Required)";

    teamMembers.forEach((member, index) => {
      const maxMembers = config.maxTeamSize - 1;
      member.style.display = index < maxMembers ? "block" : "none";
      
      // Update member labels
      const label = document.getElementById(`label${index + 2}`);
      if (label) {
        label.innerText = `Member ${index + 1}`;
      }
      
      // Clear team member inputs
      const name = document.getElementById(`name${index + 2}`);
      const college = document.getElementById(`college${index + 2}`);
      const degree = document.getElementById(`degree${index + 2}`);
      const dept = document.getElementById(`dept${index + 2}`);
      const year = document.getElementById(`year${index + 2}`);
      if (name) name.value = "";
      if (college) college.value = "";
      if (degree) degree.value = "";
      if (dept) dept.value = "";
      if (year) year.value = "";
    });

    // Show hint with min and max team size
    let hintText = `Team size: ${config.minTeamSize} to ${config.maxTeamSize} members`;
    if (config.minTeamSize === config.maxTeamSize) {
      hintText = `Team size: Exactly ${config.maxTeamSize} members required`;
    } else if (config.minTeamSize > 1) {
      hintText = `Team size: Minimum ${config.minTeamSize} to Maximum ${config.maxTeamSize} members`;
    }
    teamHint.innerText = hintText;
  }
}

/* PREFILL FROM EVENTS PAGE */
window.addEventListener("DOMContentLoaded", () => {
  const storedEvent = localStorage.getItem("event");
  if (storedEvent) {
    // ensure option exists
    const exists = Array.from(eventSelect.options).some(o => o.value === storedEvent);
    if (!exists) {
      const opt = document.createElement("option");
      opt.value = storedEvent;
      opt.text = storedEvent;
      eventSelect.appendChild(opt);
    }
    eventSelect.value = storedEvent;
    updateForm();
  }

  const storedName = localStorage.getItem("name");
  if (storedName) document.getElementById("name1").value = storedName;
  const storedEmail = localStorage.getItem("email");
  if (storedEmail) document.getElementById("email").value = storedEmail;
  const storedPhone = localStorage.getItem("phone");
  if (storedPhone) document.getElementById("phone").value = storedPhone;

  // Restore team data if available
  const storedTeam = localStorage.getItem("team");
  if (storedTeam) {
    try {
      const team = JSON.parse(storedTeam);
      if (team[0]) {
        document.getElementById("college1").value = team[0].college || "";
        document.getElementById("degree1").value = team[0].degree || "";
        document.getElementById("dept1").value = team[0].dept || "";
        document.getElementById("year1").value = team[0].year || "";
      }
      
      for (let i = 1; i < team.length; i++) {
        const member = team[i];
        const nameEl = document.getElementById(`name${i + 1}`);
        if (nameEl) {
          nameEl.value = member.name || "";
          document.getElementById(`college${i + 1}`).value = member.college || "";
          document.getElementById(`degree${i + 1}`).value = member.degree || "";
          document.getElementById(`dept${i + 1}`).value = member.dept || "";
          document.getElementById(`year${i + 1}`).value = member.year || "";
        }
      }
    } catch (e) {}
  }
});

/* SUBMIT */
document.getElementById("registerForm").addEventListener("submit", function(e){
  e.preventDefault();

  const event = eventSelect.value;
  const config = eventConfig[event];

  if (!config) {
    alert("Please select an event");
    return;
  }

  // Validate primary participant
  const name1 = document.getElementById("name1").value.trim();
  const college1 = document.getElementById("college1").value.trim();
  const degree1 = document.getElementById("degree1").value.trim();
  const dept1 = document.getElementById("dept1").value.trim();
  const year1 = document.getElementById("year1").value.trim();
  const email = document.getElementById("email").value.trim();
  const phone = document.getElementById("phone").value.trim();

  if (!name1 || !college1 || !degree1 || !dept1 || !year1 || !email || !phone) {
    alert("Please fill all required fields for the primary participant");
    return;
  }

  // Build team array with full details
  const team = [
    {
      name: name1,
      college: college1,
      degree: degree1,
      dept: dept1,
      year: year1
    }
  ];

  // For team events, validate team members
  if (config.type === "TEAM") {
    let teamMemberCount = 1;
    
    for (let i = 2; i <= 4; i++) {
      const nameEl = document.getElementById(`name${i}`);
      const collegeEl = document.getElementById(`college${i}`);
      const degreeEl = document.getElementById(`degree${i}`);
      const deptEl = document.getElementById(`dept${i}`);
      const yearEl = document.getElementById(`year${i}`);

      if (nameEl && nameEl.value.trim()) {
        teamMemberCount++;
        
        // If a team member name is provided, validate all fields
        if (!collegeEl.value.trim() || !degreeEl.value.trim() || !deptEl.value.trim() || !yearEl.value.trim()) {
          alert(`Please fill all fields for Member ${i - 1}`);
          return;
        }

        team.push({
          name: nameEl.value.trim(),
          college: collegeEl.value.trim(),
          degree: degreeEl.value.trim(),
          dept: deptEl.value.trim(),
          year: yearEl.value.trim()
        });
      }
    }

    // Check if team size is within limits
    if (teamMemberCount < config.minTeamSize) {
      if (config.minTeamSize === config.maxTeamSize) {
        alert(`This event requires exactly ${config.minTeamSize} members. You have entered ${teamMemberCount}.`);
      } else {
        alert(`This event requires minimum ${config.minTeamSize} members. You have entered ${teamMemberCount}.`);
      }
      return;
    }

    if (teamMemberCount > config.maxTeamSize) {
      alert(`Maximum team size for this event is ${config.maxTeamSize} members. You have entered ${teamMemberCount}.`);
      return;
    }
  }

  localStorage.setItem("name", name1);
  localStorage.setItem("college1", college1);
  localStorage.setItem("degree1", degree1);
  localStorage.setItem("dept1", dept1);
  localStorage.setItem("year1", year1);
  localStorage.setItem("email", email);
  localStorage.setItem("phone", phone);
  localStorage.setItem("event", event);
  localStorage.setItem("team", JSON.stringify(team));
  localStorage.setItem("amount", config.price);

  window.location.href = "payment.html";
});
</script>

<!-- ================= FOOTER ================= -->
<footer>
  <p>Instagram: <span>@yourcollege</span></p>
  <p>College Mail: <span>college@gmail.com</span></p>
  <p>TechForge Queries: <span>techfest@gmail.com</span></p>
  <p class="copyright">© 2026 JNN Institute of Engineering</p>
</footer>

<!-- ================= MOBILE MENU SCRIPT ================= -->
<script>
  function openMenu() {
    document.getElementById("mobileMenu").style.right = "0";
  }

  function closeMenu() {
    document.getElementById("mobileMenu").style.right = "-100%";
  }
</script>

</body>
</html>
